{% extends 'base/two_columns.html' %}
{% comment %}
# This file is part of OpenHatch.
# Copyright (C) 2010 Parker Phinney
# Copyright (C) 2009, 2010, 2011 OpenHatch, Inc.
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU Affero General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Affero General Public License for more details.
#
# You should have received a copy of the GNU Affero General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
{% endcomment %}


{% load base_extras %}
{% load profile_extras %}

{% block body_id %}profile{% endblock %}

{% block description_for_anonymous_users %}
    <strong>
        Learn below
    </strong>
    how
    {% firstof person.user.first_name person.user.username %}
    is involved in <abbr title='that is, Free, Libre Open Source Software'>FLOSS</abbr>
{% endblock %}

{% block pagetop %}
    <div id='nameplate'>
    {% if person.user.first_name or person.user.last_name %}
        <h1 class='name'>
            {{ person.user.first_name }}
            {{ person.user.last_name }}
                    <span class='username' style="font-size: .7em;">
                        {{ person.username }}
                        {% if editable %}
                            (<a href='{% url account.views.edit_name %}'>edit name</a>)
                        {% endif %}
                    </span>
        </h1>
    {% else %}
        <h1 class='name'>
            <a href='/people/{{ person.user.username }}'>
                <div class='name'>
                    {{ person.user.username }}
                </div>
            </a>
        </h1>

        {% if editable %}
            <a href='{% url account.views.edit_name %}' class="edit-name-link">
                <div id='edit_your_name_notification'
                     class='notification'>Tell us your name!
                </div>
            </a>
        {% endif %}
    {% endif %}
{% endblock %}

{% block left %}
    <div id='avatar' class='module'>
        {% if editable %}
            {% if person.photo %}
                <img src={% version photo_url %}>
                <div class='change-photo-link'><a href="/account/edit/photo/">Change photo</a></div>
            {% else %}
                {# Haven't uploaded a photo yet #}
                <style>

                    #avatar .default_image { background: url({% version photo_url %}) no-repeat; }
                </style>
                <a href="/account/edit/photo/" class='default_image'>
                    <div class='notification' >Upload a photo</div>
                </a>
            {% endif %}
        {% else %}
            <img src={% version photo_url %}>

        {% endif %}

        <div id='nameplate'>
            <div style="clear: left; float: left;">
                <h4>Username</h4>
                <p class="clear">{{ person.user.username }}</p>

                {% if person.location_display_name and person.location_confirmed %}
                    <h4>Location</h4>
                    <p class="clear">
                        <a style='color: #555;' href="/people/?center={{ person.location_display_name }}">
                            {{ person.location_display_name }}
                        </a>
                    </p>
                {% endif %}
                {% if editable %}
                    {% if person.location_display_name and person.location_confirmed %}
                        <h4>Location</h4>
                        <p class="clear">
                            (<a href="{% url mysite.account.views.set_location %}">edit</a>)
                        </p>
                    {% else %}
                        <h4>Location</h4>
                        <p class="clear">
                            <a href="{% url mysite.account.views.set_location %}">Set your location</a>
                        </p>
                    {% endif %}
                {% endif %}

                {% if person.company_name %}
                    <h4>Company</h4>
                    <p class="clear">{{ person.company_name }}</p>
                {% endif %}

                {% if person.user.email %}
                    {% if person.user == user or user|has_group:'ADMIN' %}
                        <h4>Email</h4>
                        <p class="clear">
                            <a href="mailto:{{ person.user.email }}">{{ person.user.email }}</a>
                        </p>
                    {% endif %}
                {% endif %}

                {% if person.linked_in_url %}
                    <h4>LinkedIn</h4>
                    <p id="linkedinurl" style='clear: both;'>
                        <a href="{{ person.linked_in_url }}">{{ person.linked_in_url }}</a>
                    </p>
                {% endif %}

            </div>

        </div>
        <!-- /.nameplate -->
    </div>

    {% if person.contact_blurb %}
        <div id='contact_blurb' class='module'>

            <div class='module-head'>
                {% if editable and not info_edit_mode %}
                    <ul>
                        <li><a class='edit' href='{% url mysite.profile.views.edit_info %}#contact_blurb'>Edit</a></li>
                    </ul>
                {% endif %}

                <h3>How to contact me</h3>

            </div>

            <div class='module-body' style='font-size: .95em;'>
                {{contact_blurb|urlizetrunc:"23"|linebreaks}}
            </div>
        </div> <!-- end of contact blurb module -->
    {% endif %}

{% endblock left %}

{% block main %}
<div id='info' class='module'>

    <div class='module-head'>
        <h3>Info</h3>
        {% if editable and not info_edit_mode %}
            <a class='edit' href='{% url mysite.profile.views.edit_info %}'>Edit</a>
        {% endif %}
    </div>

    {% if editable and not person.bio and not person.homepage_url and not tags_flat %}
        <div class='module-body has_notification'>
    {% else %}
        <div class='module-body'>
    {% endif %}

    <style>
        h4 {
            padding: 0;
        }
    </style>

    {% if projects_i_wanna_help or editable or person.bio or person.homepage_url or tags_flat %}
    {% else %}
        {# When the info box is empty on this profile #}
        <small style='color: #777;'>Nothing here yet.</small>
    {% endif %}

    {% if person.bio %}
        <h4>Bio</h4>
        <p>{{ person.bio }}</p>
    {% endif %}

    {% if person.irc_nick %}
        <h4>Irc nick</h4>
        <p>{{ person.irc_nick }}</p>
    {% endif %}

    {% if person.time_to_commit %}
        <h4>Time to commit</h4>
        <p>{{ person.time_to_commit.name }}</p>
    {% endif %}

    {% if person.skill.all|length > 0 %}
        <h4>Skills</h4>
        <p>
            {% for skill in person.skill.all %}
                {{ skill.name }}{% if forloop.counter < person.skill.all|length %}, {% endif %}
            {% endfor %}
        </p>
    {% endif %}

    {% if person.cause.all|length > 0 %}
        <h4>Causes</h4>
        <p>
            {% for cause in person.cause.all %}
                {{ cause.name }}{% if forloop.counter < person.cause.all|length %}, {% endif %}
            {% endfor %}
        </p>
    {% endif %}

    {% if person.organization.all|length > 0 %}
        <h4>Organizations</h4>
        <p>
            {% for organization in person.organization.all %}
                {{ organization.name }}{% if forloop.counter < person.organization.all|length %}, {% endif %}
            {% endfor %}
        </p>
    {% endif %}

    {% if person.language.all|length > 0 %}
        <h4>Languages</h4>
        <p>
            {% for language in person.language.all %}
                {{ language.name }}{% if forloop.counter < person.language.all|length %}, {% endif %}
            {% endfor %}
        </p>
    {% endif %}
    </div>
    </div> <!-- end of person info module -->
{% endblock %}

{% comment %}
vim: set ai et ts=4 sw=4 nu:
{% endcomment %}
